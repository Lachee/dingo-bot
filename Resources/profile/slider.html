<head>
	<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
	<script src="./js/jquery-3.4.1.min.js"></script>
	<script src="./js/jquery-ui.min.js"> </script>
	<script src="https://simeydotme.github.io/jQuery-ui-Slider-Pips/dist/js/jquery-plus-ui.min.js"></script>
    <script src="./js/jquery-ui-slider-pips.min.js"> </script>
    <script src="default-profile.js"></script>
	
	<!--
	<link rel="stylesheet" type="text/css" href="./js/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="./js/jquery-ui-slider-pips.min.css">
	<link rel="stylesheet" type="text/css" href="./css/slider.css">
	-->
	
	<link rel="stylesheet" type="text/css" href="https://simeydotme.github.io/jQuery-ui-Slider-Pips/dist/css/jqueryui.min.css">
	<link rel="stylesheet" type="text/css" href="https://simeydotme.github.io/jQuery-ui-Slider-Pips/dist/css/jquery-ui-slider-pips.min.css">
	<link rel="stylesheet" type="text/css" href="https://simeydotme.github.io/jQuery-ui-Slider-Pips/dist/css/app.min.css">
	<link rel="stylesheet" type="text/css" href="./css/slider.css">
    <style>
        body {
            /*font-family: "Open Sans","Helvetica Neue",Roboto,Arial,sans-serif;*/
			font-family: 'Roboto', sans-serif;
			background: white;
            color: black;
            padding: 0;
            margin: 0;
        }


        .profile {
            width: 540px;
            height: 450px;
            background: #434c5b;
            padding: 20px;
            color: #dddddd;
        }

        .profile-header {
            height: 185px;
        }

        img.avatar {
            height: 157px;
            float: left;
            position: absolute;
            border-radius: 115px;
            left: 0px;
            top: 0px;
        }

        img.rank {
            float: left;
            height: 70px;
            position: absolute;
            top: 100px;
            left: 111px;
            z-index: 999;
        }

        .profile-header .avatar-box {
            width: 185px;
            float: left;
            height: 100%;
            position: relative;
        }

        .profile-header .title {
            float: left;
            padding-top: 3px;
            height: 100%;
            width: 314px;
        }

        .profile-header .title .name {
            text-align: right;
            font-size: 29pt;
            font-weight: bold;
        }

        .profile-header .title .desc {
            text-align: right;
            font-size: 19pt;
            margin-top: -10px;
        }

        .profile-content #flat-slider {
            margin-left: 20px;
            margin-right: 20px;
        }
 
        .profile-header #flat-slider {
            margin-top: 39px;
        }

        span.ui-slider-handle.ui-state-default.ui-corner-all {
            width: 14px;
            height: 14px;
            top: -17px !important;
            margin-left: -7px !important;
        }

        span.ui-slider-handle.ui-state-default.ui-corner-all.current {
            width: 20px;
            height: 20px;
            top: -25px !important;
            margin-left: -10px;
        }

        .title .ui-slider-handle.current div {
            background: #434c5b;
            color: white;
            transform: rotate(-45deg);
            -webkit-transform: rotateZ(-45deg);
            bottom: -43px;
            right: -49px;
            position: absolute;
        }
    </style>
</head>
<body>

<div class="profile">
    <div class="profile-header">
        <div class="avatar-box">
            <img class="avatar" data-profile="profile.Avatar" src="https://chickatrice.net/chickatrice.png"/>
            <img class="rank"  data-profile="profile.RankSVG" src="https://chickatrice.net/chickatrice.png"/>
        </div>
        <div class="title">
            <div class="name" data-profile="profile.name">KommadantKlink</div>
            <div class="desc" data-profile="profile.Description">Montagne Main</div>
            <div id="flat-slider"></div>
        </div>
    </div>
    <div class="profile-content">
    </div>
</div>




<div class="stuff" style="display: none">
    <main>
        <div id="flat-slider"></div>
        <div id="flat-slider-vertical-1"></div>
        <div id="flat-slider-vertical-2"></div>
        <div id="flat-slider-vertical-3"></div>
    </main>
</div>


</body>
<script>
    console.log("Hello World!");

	//$.extend( $.ui.slider.prototype.options, {  animate: 300 });
	//The profile from d.lu.je/siege/profile.php
	var profile = getProfile();
	console.log("profile:", profile);
    
	//Set all the things
    setMMRSlider();
	setAttributes();
    
	
	function setAttributes() {
		function setattr(prefix, object) {
            
			for(var key in object) {
				var o = object[key];
				var t = typeof o;
				
				//If we are a correct type, set the values.
				// Otherwise go a level deeper.
				if (t == 'number' || t == 'string' || t == 'boolean') {
					$('[data-profile="' + prefix + key + '"]').text(o);
					$('img[data-profile="' + prefix + key + '"]').attr('src', o);
				} else {
					setattr(prefix + key + ".", o);
				}
            }
		}
		
		setattr("profile.", profile);
	}
	
	
	//Set the slider
	function setMMRSlider() {
		var slider = $("#flat-slider");
		var minMMR = profile.MMR;
		var currentMMR = profile.AverageMMR;
		var maxMMR = profile.BestMMR;			
		var rangeMinMMR = minMMR - (minMMR * 0.1);
		var rangeMaxMMR = maxMMR + (maxMMR * 0.1);
	
		//Add the slider
		slider
			.slider({
				min: rangeMinMMR,
				max: rangeMaxMMR,
				range: true,
				values: [minMMR, maxMMR]
			}).slider("pips", { first: "pip", last: "pip" });

		//Add the fake pip
		var left = ((currentMMR - rangeMinMMR) / (rangeMaxMMR - rangeMinMMR)) * 100;
		var fakePip = $("<span></span>").addClass('ui-slider-handle ui-state-default ui-corner-all current').css('left', left + "%");  
        fakePip.html("<div data-profile=\"profile.MMR\"></div>");
		slider.prepend(fakePip);
	}
    
	function getProfile() {
        var profile = getCookie("profile");

        if (profile == "") { 
            profile = DEFAULT_PROFILE;
        } else {
            profile = decodeURIComponent(profile);
        }

        var json = atob(profile);
		return JSON.parse(json);
	}

	function getCookie(cname) {
	  var name = cname + "=";
	  var decodedCookie = decodeURIComponent(document.cookie);
	  var ca = decodedCookie.split(';');
	  for(var i = 0; i <ca.length; i++) {
		var c = ca[i];
		while (c.charAt(0) == ' ') {
		  c = c.substring(1);
		}
		if (c.indexOf(name) == 0) {
		  return c.substring(name.length, c.length);
		}
	  }
	  return "";
	}
	
	function setCookie(cname, cvalue, exdays) {
	  var d = new Date();
	  d.setTime(d.getTime() + (exdays*24*60*60*1000));
	  var expires = "expires="+ d.toUTCString();
	  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
	}

	/*
$("#flat-slider-vertical-1")
    .slider({
        max: 25,
        min: 0,
        range: "min",
        value: 25,
        orientation: "vertical"
    });

    $("#flat-slider-vertical-2")
    .slider({
        max: 25,
        min: 0,
        range: "max",
        value: 12,
        orientation: "vertical"
    });

$("#flat-slider-vertical-3")
    .slider({
        max: 25,
        min: 0,
        range: "min",
        value: 0,
        orientation: "vertical"
    });

    $("#flat-slider-vertical-1, #flat-slider-vertical-2, #flat-slider-vertical-3")
    .slider("pips", {
        first: "pip",
        last: "pip"
    })
    .slider("float");
	*/

    
</script>
